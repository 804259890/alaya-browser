<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.platon.browser.persistence.dao.mapper.StatisticBusinessMapper">
<update id="addressChange" parameterType="com.platon.browser.common.complement.dto.statistic.AddressStatChange">
    <foreach collection="addressStatItemList" item="item"  separator="," >
    insert into `address`
    (
        `address`,
        `type`,
        `tx_qty`,
        `transfer_qty`,
        `delegate_qty`,
        `staking_qty`,
        `proposal_qty`,
        `contract_name`,
        `contract_create`,
        `contract_createHash`
    )
    values
    (
        #{item.address},
        #{item.type},
        #{item.txQty},
        #{item.transferQty},
        #{item.delegateQty},
        #{item.stakingQty},
        #{item.proposalQty},
        #{item.contractName},
        #{item.contractCreate},
        #{item.contractCreatehash}
    )
    on duplicate
    key update
        `tx_qty` = `tx_qty` + #{item.txQty},
        `transfer_qty` = `transfer_qty` + #{item.transferQty},
        `delegate_qty` = `delegate_qty` + #{item.delegateQty},
        `staking_qty` = `staking_qty` + #{item.stakingQty},
        `proposal_qty` = `proposal_qty` + #{item.proposalQty};
    </foreach>
</update>
</mapper>